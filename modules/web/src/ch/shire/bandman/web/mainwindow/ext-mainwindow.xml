<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<window xmlns="http://schemas.haulmont.com/cuba/window.xsd"
        class="ch.shire.bandman.web.mainwindow.ExtAppMainWindow"
        extends="/com/haulmont/cuba/web/app/mainwindow/mainwindow.xml"
        xmlns:main="http://schemas.haulmont.com/cuba/mainwindow.xsd">
    <dsContext>
        <collectionDatasource id="shoppingDs"
                              class="ch.shire.bandman.entity.Shopping"
                              maxResults="50"
                              view="_local">
            <query>
                <![CDATA[select e from bandman$Shopping e where e.bought IS NULL or e.bought = false order by e.createTs asc]]>
            </query>
        </collectionDatasource>
        <collectionDatasource id="todoDs"
                              class="ch.shire.bandman.entity.ToDo"
                              view="_local">
            <query>
                <![CDATA[select e from bandman$ToDo e where e.finished is null or e.finished = false order by e.createTs]]>
            </query>
        </collectionDatasource>
        <collectionDatasource id="bookingDs"
                              class="ch.shire.bandman.entity.Booking"
                              view="bookingWithParticipants">
            <query>
                <![CDATA[select e from bandman$Booking e where e.bookingEnd >= CURRENT_DATE  order by e.bookingStart asc]]>
            </query>
        </collectionDatasource>
    </dsContext>
    <layout>
        <hbox id="titleBar">
            <embedded id="logoImage"
                      visible="false"/>
        </hbox>
        <split id="foldersSplit"
               pos="6">
            <main:workArea id="workArea">
                <main:initialLayout spacing="false">
                    <split id="toolsSplitPanel"
                           height="100%"
                           orientation="horizontal"
                           width="100%">
                        <split id="hsplitPanel"
                               height="100%"
                               orientation="vertical"
                               width="100%">
                            <groupBox id="todoGroup"
                                      caption="ToDo"
                                      collapsed="true"
                                      height="100%"
                                      spacing="true">
                                <table id="todoTable"
                                       height="100%"
                                       width="100%">
                                    <actions>
                                        <action id="create"/>
                                        <action id="remove"/>
                                        <action id="refresh"/>
                                        <action id="edit"/>
                                    </actions>
                                    <columns>
                                        <column id="taskName"/>
                                        <column id="dueDate"/>
                                        <column id="finished"/>
                                        <column id="description"
                                                visible="false"/>
                                    </columns>
                                    <rows datasource="todoDs"/>
                                    <buttonsPanel>
                                        <button id="addTodo"
                                                action="todoTable.create"/>
                                        <button id="refresh"
                                                action="todoTable.refresh"/>
                                    </buttonsPanel>
                                </table>
                            </groupBox>
                            <groupBox id="shoppingGroup"
                                      caption="Shopping List"
                                      collapsed="true"
                                      height="100%"
                                      spacing="true">
                                <table id="shoppingTable"
                                       height="100%"
                                       multiselect="true"
                                       width="100%">
                                    <actions>
                                        <action id="create"/>
                                        <action id="edit"/>
                                        <action id="remove"/>
                                        <action id="refresh"/>
                                    </actions>
                                    <columns>
                                        <column id="item"/>
                                        <column id="bought"
                                                collapsed="true"
                                                width="50px"/>
                                        <column id="description"
                                                visible="false"/>
                                    </columns>
                                    <rows datasource="shoppingDs"/>
                                    <buttonsPanel>
                                        <button id="addShoppingItem"
                                                action="shoppingTable.create"/>
                                        <button id="refreshShopppingList"
                                                action="shoppingTable.refresh"/>
                                    </buttonsPanel>
                                </table>
                            </groupBox>
                        </split>
                        <groupBox id="bookingGroup"
                                  caption="Booking"
                                  collapsed="true"
                                  height="100%"
                                  spacing="true">
                            <table id="bookingTable"
                                   height="100%"
                                   width="100%">
                                <actions>
                                    <action id="create"/>
                                    <action id="remove"/>
                                    <action id="refresh"/>
                                    <action id="edit"/>
                                </actions>
                                <columns>
                                    <column id="bookingStart"/>
                                    <column id="bookingEnd"/>
                                    <column id="title"/>
                                    <column id="description"/>
                                    <column id="doNotDisturb"/>
                                </columns>
                                <rows datasource="bookingDs"/>
                                <buttonsPanel>
                                    <button id="button_1"
                                            action="bookingTable.create"/>
                                    <button id="button_3"
                                            action="bookingTable.refresh"/>
                                </buttonsPanel>
                            </table>
                        </groupBox>
                    </split>
                </main:initialLayout>
            </main:workArea>
        </split>
    </layout>
</window>
